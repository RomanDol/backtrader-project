{% extends "base.html" %} {% block title %}Strategy Backtest - Backtrader
Platform{% endblock %} {% block content %}
<div
  style="
    display: flex;
    height: calc(100vh - var(--nav-height));
    overflow: hidden;
  "
>
  <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å (2/3 —à–∏—Ä–∏–Ω—ã) - —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –≤–µ—Ä—Ö –∏ –Ω–∏–∑ -->
  <div
    style="
      flex: 2;
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
      padding: var(--spacing-sm);
    "
  >
    <!-- –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å - –ì—Ä–∞—Ñ–∏–∫ —Å–≤–µ—á–µ–π -->
    <div style="flex: 1">
      <div id="candlestick-chart" style="width: 100%; height: 100%"></div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è —á–∞—Å—Ç—å - –ì—Ä–∞—Ñ–∏–∫ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏  -->
    <div style="flex: 1">
      <!--  Grafana -->
      <div class="">
        <div
          style="
            height: 45vh;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            overflow: hidden;
          "
        >
          <iframe
            src="http://localhost:3000/public-dashboards/0f9b339850ba4dc98153d6ef0b5499df"
            width="100%"
            height="100%"
            frameborder="0"
          >
          </iframe>
        </div>
      </div>
    </div>
  </div>

  <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å (1/3 —à–∏—Ä–∏–Ω—ã) - –§–æ—Ä–º–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ -->
  <div
    style="
      flex: 1;
      background: var(--bg-gradient-primary);
      border-left: var(--border-width) solid var(--border-color);
      padding: var(--spacing-lg);
      overflow-y: auto;
    "
  >
    <h2 style="margin: 0 0 var(--spacing-md) 0; color: var(--color-primary)">
      ‚öôÔ∏è Strategy Parameters
    </h2>

    <form id="backtest-form">
      <div class="form-group">
        <label for="strategy-select">Strategy:</label>
        <select id="strategy-select" name="strategy" required>
          <option value="">Loading strategies...</option>
        </select>
      </div>

      <div class="form-group">
        <label for="symbol-select">Symbol:</label>
        <select id="symbol-select" name="symbol" required>
          <option value="">Select symbol...</option>
        </select>
      </div>

      <div class="form-group">
        <label for="timeframe-select">Timeframe:</label>
        <select id="timeframe-select" name="timeframe" required>
          <option value="">Select timeframe...</option>
        </select>
      </div>

      <div class="form-group">
        <label for="start-date">Start Date:</label>
        <input type="date" id="start-date" name="start_date" required />
      </div>

      <div class="form-group">
        <label for="end-date">End Date:</label>
        <input type="date" id="end-date" name="end_date" required />
      </div>

      <div class="form-actions">
        <button
          type="button"
          id="load-chart-btn"
          class="btn btn-primary"
          style="width: 100%"
        >
          <span class="btn-icon">üìä</span>
          Load Chart
        </button>
      </div>

      <hr
        style="
          margin: var(--spacing-lg) 0;
          border: none;
          border-top: var(--border-width) solid var(--border-color);
        "
      />

      <h3
        style="margin: 0 0 var(--spacing-md) 0; color: var(--color-secondary)"
      >
        Strategy Settings
      </h3>

      <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ -->
      <div id="strategy-params-container"></div>

      <hr
        style="
          margin: var(--spacing-lg) 0;
          border: none;
          border-top: var(--border-width) solid var(--border-color);
        "
      />

      <div class="form-group">
        <label for="initial-cash">Initial Cash ($):</label>
        <input
          type="number"
          id="initial-cash"
          name="initial_cash"
          value="10000"
          min="100"
          step="100"
          required
        />
      </div>

      <div class="form-group">
        <label for="commission">Commission (%):</label>
        <input
          type="number"
          id="commission"
          name="commission"
          value="0.1"
          min="0"
          max="5"
          step="0.01"
          required
        />
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" style="width: 100%">
          <span class="btn-icon">‚ñ∂Ô∏è</span>
          Run Backtest
        </button>
      </div>
    </form>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div
      id="backtest-message"
      class="message"
      style="display: none; margin-top: var(--spacing-md)"
    ></div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞ -->
    <div
      id="results-container"
      style="margin-top: var(--spacing-lg); display: none"
    >
      <h3 style="margin: 0 0 var(--spacing-md) 0; color: var(--color-success)">
        üìä Results
      </h3>
      <div id="results-table"></div>
    </div>

    <div
      id="backtest-message"
      class="message"
      style="display: none; margin-top: var(--spacing-md)"
    ></div>
  </div>
</div>
{% endblock %} {% block js %}
<script src="https://unpkg.com/lightweight-charts@4.2.0/dist/lightweight-charts.standalone.production.js"></script>
<script>
  // –ñ–¥—ë–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
  window.addEventListener("load", function () {
    console.log("Window fully loaded")
    console.log("LightweightCharts:", typeof LightweightCharts)
  })
</script>
<script src="{{ url_for('static', filename='js/backtest.js') }}" defer></script>
{% endblock %}
